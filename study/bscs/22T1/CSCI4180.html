<!doctype html>
<html lang="zh-CN" data-theme="light">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <meta name="generator" content="VuePress 2.0.0-rc.26" />
    <meta name="theme" content="VuePress Theme Hope 2.0.0-rc.102" />
    <style>
      :root {
        --vp-c-bg: #fff;
      }

      [data-theme="dark"] {
        --vp-c-bg: #1b1b1f;
      }

      html,
      body {
        background: var(--vp-c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem("vuepress-theme-hope-scheme");
      const systemDarkMode =
        window.matchMedia &&
        window.matchMedia("(prefers-color-scheme: dark)").matches;

      if (userMode === "dark" || (userMode !== "light" && systemDarkMode)) {
        document.documentElement.setAttribute("data-theme", "dark");
      }
    </script>
    <script type="application/ld+json">{"@context":"https://schema.org","@type":"Article","headline":"CSCI4180 Introduction to Cloud Computing and Storage","image":[""],"dateModified":"2026-02-26T10:30:12.000Z","author":[{"@type":"Person","name":"Dale","url":"https://github.com/shyu216"}]}</script><meta property="og:url" content="https://shyu216.github.io/knownoevil/knownoevil/study/bscs/22T1/CSCI4180.html"><meta property="og:site_name" content="SIHONG's Blog"><meta property="og:title" content="CSCI4180 Introduction to Cloud Computing and Storage"><meta property="og:description" content="What is this course about? 前半部分是计算，后半是存储。怎么处理海量数据而不卡死，怎么保存海量数据而不撑爆。 核心前提：MapReduce的核心分工 先明确Map/Reduce的核心逻辑，所有分布式算法都是基于这个分工设计： Map函数：「分片处理」—— 把大规模数据拆成小分片，每个分片独立计算局部结果（无数据依赖）； Red..."><meta property="og:type" content="article"><meta property="og:locale" content="zh-CN"><meta property="og:updated_time" content="2026-02-26T10:30:12.000Z"><meta property="article:tag" content="Storage"><meta property="article:tag" content="Cloud Computing"><meta property="article:tag" content="Computer Science"><meta property="article:modified_time" content="2026-02-26T10:30:12.000Z"><meta name="application-name" content="SIHONG's Blog"><meta name="mobile-web-app-capable" content="yes"><meta name="theme-color" content="#46bd87"><meta name="apple-mobile-web-app-status-bar-style" content="black"><link rel="icon" href="/knownoevil/favicon.ico"><link rel="manifest" href="/knownoevil/manifest.webmanifest" crossorigin="use-credentials"><link rel="icon" href="/knownoevil/assets/icon/android-chrome-512x512.png" type="image/png" sizes="512x512"><link rel="icon" href="/knownoevil/assets/icon/android-chrome-192x192.png" type="image/png" sizes="192x192"><link rel="apple-touch-icon" href="/knownoevil/assets/icon/apple-touch-icon.png"><title>CSCI4180 Introduction to Cloud Computing and Storage | SIHONG's Blog</title><meta name="description" content="What is this course about? 前半部分是计算，后半是存储。怎么处理海量数据而不卡死，怎么保存海量数据而不撑爆。 核心前提：MapReduce的核心分工 先明确Map/Reduce的核心逻辑，所有分布式算法都是基于这个分工设计： Map函数：「分片处理」—— 把大规模数据拆成小分片，每个分片独立计算局部结果（无数据依赖）； Red...">
    <link rel="preload" href="/knownoevil/assets/style-Da_-Pejh.css" as="style"><link rel="stylesheet" href="/knownoevil/assets/style-Da_-Pejh.css">
    <link rel="modulepreload" href="/knownoevil/assets/app-BJBWOcsO.js"><link rel="modulepreload" href="/knownoevil/assets/CSCI4180.html-DEndpA3v.js"><link rel="modulepreload" href="/knownoevil/assets/plugin-vue_export-helper-DlAUqK2U.js">
    
  </head>
  <body>
    <div id="app"><!--[--><!--[--><!--[--><span tabindex="-1"></span><a href="#main-content" class="vp-skip-link sr-only">跳至主要內容</a><!--]--><!--[--><div class="theme-container external-link-icon has-toc" vp-container><!--[--><header id="navbar" class="vp-navbar" vp-navbar><div class="vp-navbar-start"><button type="button" class="vp-toggle-sidebar-button" title="Toggle Sidebar"><span class="icon"></span></button><!--[--><a class="route-link vp-brand" href="/knownoevil/" aria-label="带我回家"><img class="vp-nav-logo" src="https://github.com/shyu216.png" alt><!----><span class="vp-site-name hide-in-pad">SIHONG&#39;s Blog</span></a><!--]--></div><div class="vp-navbar-center"><!--[--><nav class="vp-nav-links"><div class="vp-nav-item hide-in-mobile"><a class="route-link route-link-active auto-link" href="/knownoevil/study/" aria-label="Study"><!--[--><i class="vp-icon fas fa-chalkboard-teacher" sizing="height"></i><!--]-->Study<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/knownoevil/coding/" aria-label="Coding"><!--[--><i class="vp-icon fas fa-bug" sizing="height"></i><!--]-->Coding<!----></a></div><div class="vp-nav-item hide-in-mobile"><a class="route-link auto-link" href="/knownoevil/life/" aria-label="Life"><!--[--><i class="vp-icon fas fa-earth-asia" sizing="height"></i><!--]-->Life<!----></a></div></nav><!--]--></div><div class="vp-navbar-end"><!--[--><!----><div class="vp-nav-item vp-action"><a class="vp-action-link" href="https://github.com/shyu216/knownoevil" target="_blank" rel="noopener noreferrer" aria-label="GitHub"><svg xmlns="http://www.w3.org/2000/svg" class="icon github-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="github icon" name="github" style="width:1.25rem;height:1.25rem;vertical-align:middle;"><path d="M511.957 21.333C241.024 21.333 21.333 240.981 21.333 512c0 216.832 140.544 400.725 335.574 465.664 24.49 4.395 32.256-10.07 32.256-23.083 0-11.69.256-44.245 0-85.205-136.448 29.61-164.736-64.64-164.736-64.64-22.315-56.704-54.4-71.765-54.4-71.765-44.587-30.464 3.285-29.824 3.285-29.824 49.195 3.413 75.179 50.517 75.179 50.517 43.776 75.008 114.816 53.333 142.762 40.79 4.523-31.66 17.152-53.377 31.19-65.537-108.971-12.458-223.488-54.485-223.488-242.602 0-53.547 19.114-97.323 50.517-131.67-5.035-12.33-21.93-62.293 4.779-129.834 0 0 41.258-13.184 134.912 50.346a469.803 469.803 0 0 1 122.88-16.554c41.642.213 83.626 5.632 122.88 16.554 93.653-63.488 134.784-50.346 134.784-50.346 26.752 67.541 9.898 117.504 4.864 129.834 31.402 34.347 50.474 78.123 50.474 131.67 0 188.586-114.73 230.016-224.042 242.09 17.578 15.232 33.578 44.672 33.578 90.454v135.85c0 13.142 7.936 27.606 32.854 22.87C862.25 912.597 1002.667 728.747 1002.667 512c0-271.019-219.648-490.667-490.71-490.667z"></path></svg></a></div><div class="vp-nav-item hide-in-mobile"><button type="button" class="vp-color-mode-switch" id="color-mode-switch"><svg xmlns="http://www.w3.org/2000/svg" class="icon auto-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="auto icon" name="auto" style="display:block;"><path d="M512 992C246.92 992 32 777.08 32 512S246.92 32 512 32s480 214.92 480 480-214.92 480-480 480zm0-840c-198.78 0-360 161.22-360 360 0 198.84 161.22 360 360 360s360-161.16 360-360c0-198.78-161.22-360-360-360zm0 660V212c165.72 0 300 134.34 300 300 0 165.72-134.28 300-300 300z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon dark-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="dark icon" name="dark" style="display:none;"><path d="M524.8 938.667h-4.267a439.893 439.893 0 0 1-313.173-134.4 446.293 446.293 0 0 1-11.093-597.334A432.213 432.213 0 0 1 366.933 90.027a42.667 42.667 0 0 1 45.227 9.386 42.667 42.667 0 0 1 10.24 42.667 358.4 358.4 0 0 0 82.773 375.893 361.387 361.387 0 0 0 376.747 82.774 42.667 42.667 0 0 1 54.187 55.04 433.493 433.493 0 0 1-99.84 154.88 438.613 438.613 0 0 1-311.467 128z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon light-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="light icon" name="light" style="display:none;"><path d="M952 552h-80a40 40 0 0 1 0-80h80a40 40 0 0 1 0 80zM801.88 280.08a41 41 0 0 1-57.96-57.96l57.96-58a41.04 41.04 0 0 1 58 58l-58 57.96zM512 752a240 240 0 1 1 0-480 240 240 0 0 1 0 480zm0-560a40 40 0 0 1-40-40V72a40 40 0 0 1 80 0v80a40 40 0 0 1-40 40zm-289.88 88.08-58-57.96a41.04 41.04 0 0 1 58-58l57.96 58a41 41 0 0 1-57.96 57.96zM192 512a40 40 0 0 1-40 40H72a40 40 0 0 1 0-80h80a40 40 0 0 1 40 40zm30.12 231.92a41 41 0 0 1 57.96 57.96l-57.96 58a41.04 41.04 0 0 1-58-58l58-57.96zM512 832a40 40 0 0 1 40 40v80a40 40 0 0 1-80 0v-80a40 40 0 0 1 40-40zm289.88-88.08 58 57.96a41.04 41.04 0 0 1-58 58l-57.96-58a41 41 0 0 1 57.96-57.96z"></path></svg></button></div><form class="search-box" role="search"><input type="search" placeholder="搜索" autocomplete="off" spellcheck="false" value><!----></form><!--]--><button type="button" class="vp-toggle-navbar-button" aria-label="Toggle Navbar" aria-expanded="false" aria-controls="nav-screen"><span><span class="vp-top"></span><span class="vp-middle"></span><span class="vp-bottom"></span></span></button></div></header><!----><!--]--><!----><div class="toggle-sidebar-wrapper"><span class="arrow start"></span></div><aside id="sidebar" class="vp-sidebar" vp-sidebar><!----><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">CUHK</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">19T1</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">19T2</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">20T1</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">20T2</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">21T1</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">21T2</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable active" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">22T1</span><span class="vp-arrow down"></span></button><ul class="vp-sidebar-links"><li><a class="route-link route-link-active auto-link vp-sidebar-link active" href="/knownoevil/study/bscs/22T1/CSCI4180.html" aria-label="CSCI4180"><!--[--><i class="vp-icon fas fa-book-open fa-fw" sizing="both"></i><!--]-->CSCI4180<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/knownoevil/study/bscs/22T1/ESTR2106.html" aria-label="ESTR2106"><!--[--><i class="vp-icon fas fa-book-open fa-fw" sizing="both"></i><!--]-->ESTR2106<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/knownoevil/study/bscs/22T1/ESTR4998.html" aria-label="ESTR4998"><!--[--><i class="vp-icon fas fa-book-open fa-fw" sizing="both"></i><!--]-->ESTR4998<!----></a></li><li><a class="route-link auto-link vp-sidebar-link" href="/knownoevil/study/bscs/22T1/IERG4130.html" aria-label="IERG4130"><!--[--><i class="vp-icon fas fa-book-open fa-fw" sizing="both"></i><!--]-->IERG4130<!----></a></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">22T2</span><span class="vp-arrow end"></span></button><!----></section></li></ul></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-graduation-cap fa-fw" sizing="both"></i><span class="vp-sidebar-title">IELTS</span><span class="vp-arrow end"></span></button><!----></section></li><li><section class="vp-sidebar-group"><button class="vp-sidebar-header clickable" type="button"><i class="vp-icon fas fa-book fa-fw" sizing="both"></i><span class="vp-sidebar-title">UniMelb</span><span class="vp-arrow end"></span></button><!----></section></li></ul><!----></aside><!--[--><main id="main-content" class="vp-page"><!--[--><!----><!----><nav class="vp-breadcrumb disable"></nav><div class="vp-page-title"><h1><i class="vp-icon fas fa-book-open" sizing="height"></i>CSCI4180 Introduction to Cloud Computing and Storage</h1><div class="page-info"><span class="page-author-info" aria-label="作者🖊" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon author-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="author icon" name="author"><path d="M649.6 633.6c86.4-48 147.2-144 147.2-249.6 0-160-128-288-288-288s-288 128-288 288c0 108.8 57.6 201.6 147.2 249.6-121.6 48-214.4 153.6-240 288-3.2 9.6 0 19.2 6.4 25.6 3.2 9.6 12.8 12.8 22.4 12.8h704c9.6 0 19.2-3.2 25.6-12.8 6.4-6.4 9.6-16 6.4-25.6-25.6-134.4-121.6-240-243.2-288z"></path></svg><span><a class="page-author-item" href="https://github.com/shyu216" target="_blank" rel="noopener noreferrer">Dale</a></span><span property="author" content="Dale"></span></span><!----><span class="page-date-info" aria-label="写作日期📅" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon calendar-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="calendar icon" name="calendar"><path d="M716.4 110.137c0-18.753-14.72-33.473-33.472-33.473-18.753 0-33.473 14.72-33.473 33.473v33.473h66.993v-33.473zm-334.87 0c0-18.753-14.72-33.473-33.473-33.473s-33.52 14.72-33.52 33.473v33.473h66.993v-33.473zm468.81 33.52H716.4v100.465c0 18.753-14.72 33.473-33.472 33.473a33.145 33.145 0 01-33.473-33.473V143.657H381.53v100.465c0 18.753-14.72 33.473-33.473 33.473a33.145 33.145 0 01-33.473-33.473V143.657H180.6A134.314 134.314 0 0046.66 277.595v535.756A134.314 134.314 0 00180.6 947.289h669.74a134.36 134.36 0 00133.94-133.938V277.595a134.314 134.314 0 00-133.94-133.938zm33.473 267.877H147.126a33.145 33.145 0 01-33.473-33.473c0-18.752 14.72-33.473 33.473-33.473h736.687c18.752 0 33.472 14.72 33.472 33.473a33.145 33.145 0 01-33.472 33.473z"></path></svg><span data-allow-mismatch="text">2025/5/11</span><meta property="datePublished" content="2025-05-11T09:38:26.000Z"></span><!----><span class="page-reading-time-info" aria-label="阅读时间⌛" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon timer-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="timer icon" name="timer"><path d="M799.387 122.15c4.402-2.978 7.38-7.897 7.38-13.463v-1.165c0-8.933-7.38-16.312-16.312-16.312H256.33c-8.933 0-16.311 7.38-16.311 16.312v1.165c0 5.825 2.977 10.874 7.637 13.592 4.143 194.44 97.22 354.963 220.201 392.763-122.204 37.542-214.893 196.511-220.2 389.397-4.661 5.049-7.638 11.651-7.638 19.03v5.825h566.49v-5.825c0-7.379-2.849-13.981-7.509-18.9-5.049-193.016-97.867-351.985-220.2-389.527 123.24-37.67 216.446-198.453 220.588-392.892zM531.16 450.445v352.632c117.674 1.553 211.787 40.778 211.787 88.676H304.097c0-48.286 95.149-87.382 213.728-88.676V450.445c-93.077-3.107-167.901-81.297-167.901-177.093 0-8.803 6.99-15.793 15.793-15.793 8.803 0 15.794 6.99 15.794 15.793 0 80.261 63.69 145.635 142.01 145.635s142.011-65.374 142.011-145.635c0-8.803 6.99-15.793 15.794-15.793s15.793 6.99 15.793 15.793c0 95.019-73.789 172.82-165.96 177.093z"></path></svg><span>大约 6 分钟</span><meta property="timeRequired" content="PT6M"></span><span class="page-category-info" aria-label="分类🌈" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon category-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="category icon" name="category"><path d="M148.41 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H148.41c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.311-40.31zM147.556 553.478H429.73c22.263 0 40.311 18.048 40.311 40.31v282.176c0 22.263-18.048 40.312-40.31 40.312H147.555c-22.263 0-40.311-18.049-40.311-40.312V593.79c0-22.263 18.048-40.311 40.31-40.311zM593.927 106.992h282.176c22.263 0 40.31 18.048 40.31 40.31V429.48c0 22.263-18.047 40.31-40.31 40.31H593.927c-22.263 0-40.311-18.047-40.311-40.31V147.302c0-22.263 18.048-40.31 40.31-40.31zM730.22 920.502H623.926c-40.925 0-74.22-33.388-74.22-74.425V623.992c0-41.038 33.387-74.424 74.425-74.424h222.085c41.038 0 74.424 33.226 74.424 74.067v114.233c0 10.244-8.304 18.548-18.547 18.548s-18.548-8.304-18.548-18.548V623.635c0-20.388-16.746-36.974-37.33-36.974H624.13c-20.585 0-37.331 16.747-37.331 37.33v222.086c0 20.585 16.654 37.331 37.126 37.331H730.22c10.243 0 18.547 8.304 18.547 18.547 0 10.244-8.304 18.547-18.547 18.547z"></path></svg><!--[--><span class="page-category-item color0 clickable" role="navigation">CUHK</span><span class="page-category-item color0 clickable" role="navigation">Course</span><span class="page-category-item color0 clickable" role="navigation">22T1</span><!--]--><meta property="articleSection" content="CUHK,Course,22T1"></span><span class="page-tag-info" aria-label="标签🏷" data-balloon-pos="up"><svg xmlns="http://www.w3.org/2000/svg" class="icon tag-icon" viewBox="0 0 1024 1024" fill="currentColor" aria-label="tag icon" name="tag"><path d="M939.902 458.563L910.17 144.567c-1.507-16.272-14.465-29.13-30.737-30.737L565.438 84.098h-.402c-3.215 0-5.726 1.005-7.634 2.913l-470.39 470.39a10.004 10.004 0 000 14.164l365.423 365.424c1.909 1.908 4.42 2.913 7.132 2.913s5.223-1.005 7.132-2.913l470.39-470.39c2.01-2.11 3.014-5.023 2.813-8.036zm-240.067-72.121c-35.458 0-64.286-28.828-64.286-64.286s28.828-64.285 64.286-64.285 64.286 28.828 64.286 64.285-28.829 64.286-64.286 64.286z"></path></svg><!--[--><span class="page-tag-item color0 clickable" role="navigation">Computer Science</span><span class="page-tag-item color0 clickable" role="navigation">Cloud Computing</span><span class="page-tag-item color0 clickable" role="navigation">Storage</span><!--]--><meta property="keywords" content="Computer Science,Cloud Computing,Storage"></span></div><hr></div><!----><div class="" vp-content><!----><div id="markdown-content"><h3 id="what-is-this-course-about" tabindex="-1"><a class="header-anchor" href="#what-is-this-course-about"><span>What is this course about?</span></a></h3><p>前半部分是计算，后半是存储。怎么处理海量数据而不卡死，怎么保存海量数据而不撑爆。</p><h3 id="核心前提-mapreduce的核心分工" tabindex="-1"><a class="header-anchor" href="#核心前提-mapreduce的核心分工"><span>核心前提：MapReduce的核心分工</span></a></h3><p>先明确Map/Reduce的核心逻辑，所有分布式算法都是基于这个分工设计：</p><ul><li><strong>Map函数</strong>：「分片处理」—— 把大规模数据拆成小分片，每个分片独立计算局部结果（无数据依赖）；</li><li><strong>Reduce函数</strong>：「聚合归约」—— 把所有Map的局部结果汇总，计算全局最终结果；</li><li>迭代型算法（K-Means/PageRank）：多轮MapReduce循环，直到结果收敛（对应你代码里的<code>while run_next</code>）。</li></ul><hr><h3 id="经典算法的核心思路-map-reduce分工" tabindex="-1"><a class="header-anchor" href="#经典算法的核心思路-map-reduce分工"><span>经典算法的核心思路 + Map/Reduce分工</span></a></h3><h4 id="wordcount-with-counter-带计数器的词频统计" tabindex="-1"><a class="header-anchor" href="#wordcount-with-counter-带计数器的词频统计"><span>WordCount with Counter（带计数器的词频统计）</span></a></h4><h5 id="经典思路-核心" tabindex="-1"><a class="header-anchor" href="#经典思路-核心"><span>经典思路（核心）</span></a></h5><p>WordCount是MapReduce的入门核心场景：原本单机统计海量文本词频会因数据量过大卡死，核心是“分而治之”——先把文本拆分成单词，统计每个分片的局部词频，再汇总所有分片的结果得到全局词频；<br><strong>Counter（计数器）</strong> 是MapReduce的扩展能力：在统计词频的同时，用分布式计数器实时监控任务状态（如总单词数、空行数量、特殊字符数），无需额外遍历数据，提升任务可观测性。</p><h5 id="map-reduce分工" tabindex="-1"><a class="header-anchor" href="#map-reduce分工"><span>Map/Reduce分工</span></a></h5><table><thead><tr><th>阶段</th><th>Map函数做什么</th><th>Reduce函数做什么</th></tr></thead><tbody><tr><td>数据处理</td><td>1. 读取文本分片（按行读取），初始化3个Counter：<br> - <code>TOTAL_WORDS</code>（总单词数）<br> - <code>EMPTY_LINES</code>（空行数）<br> - <code>SPECIAL_CHARS</code>（特殊字符数）<br>2. 逐行处理：<br> - 若行为空，<code>EMPTY_LINES +=1</code>；<br> - 清洗行数据（去标点/转小写），拆分出单词；<br> - 每拆分一个单词，<code>TOTAL_WORDS +=1</code>；若单词含特殊字符，<code>SPECIAL_CHARS +=1</code>；<br>3. 输出局部词频：<code>单词\t1</code></td><td>1. 输入：同一个单词的所有局部计数（如<code>hello\t1</code>、<code>hello\t1</code>）；<br>2. 聚合：累加同一个单词的计数（如<code>hello\t2</code>）；<br>3. 输出全局词频：<code>单词\t总次数</code>；<br>4. 无需额外操作Counter（Counter由MapReduce框架自动汇总所有Map节点的计数，任务结束后可直接查看）</td></tr><tr><td>结果输出</td><td>-</td><td>1. 输出最终的全局词频表；<br>2. MapReduce框架自动输出Counter汇总结果（如总单词数=100万、空行数=5000）</td></tr></tbody></table><h4 id="补充说明-counter的核心价值" tabindex="-1"><a class="header-anchor" href="#补充说明-counter的核心价值"><span>补充说明（Counter的核心价值）</span></a></h4><ul><li>Counter是MapReduce的<strong>分布式监控工具</strong>，无需在Map/Reduce中显式传递计数数据，框架会自动汇总所有节点的Counter值；</li><li>相比“额外统计计数再输出”，Counter更轻量（不占用Reduce的聚合资源），还能实时查看任务进度（比如跑任务时能看到“已统计10万单词”）。</li></ul><h4 id="并行dijkstra-单源最短路径" tabindex="-1"><a class="header-anchor" href="#并行dijkstra-单源最短路径"><span>并行Dijkstra（单源最短路径）</span></a></h4><h5 id="经典思路-核心-1" tabindex="-1"><a class="header-anchor" href="#经典思路-核心-1"><span>经典思路（核心）</span></a></h5><p>Dijkstra原本是单机算法：从起点出发，不断更新“起点到各节点的最短距离”，直到所有节点都被遍历。<br> 并行化核心：把节点/边分片，多节点同时计算局部最短路径，再汇总全局最短值，避免单机处理大规模图的性能瓶颈。</p><h5 id="map-reduce分工-1" tabindex="-1"><a class="header-anchor" href="#map-reduce分工-1"><span>Map/Reduce分工</span></a></h5><table><thead><tr><th>阶段</th><th>Map函数做什么</th><th>Reduce函数做什么</th></tr></thead><tbody><tr><td>初始化</td><td>读取图的边数据（格式：<code>起点\t终点\t边权重</code>），输出：<br>- 起点的已知最短距离（如起点A初始为0，其他为∞）<br>- 格式：<code>节点ID\t(距离, 来源边)</code></td><td>无（第一轮仅初始化距离表）</td></tr><tr><td>迭代计算</td><td>输入：上一轮Reduce输出的「节点-最短距离」+ 原图边数据<br>对每条边（u→v，权重w），计算：<code>新距离 = u的已知距离 + w</code><br>输出：<code>v\t新距离</code>（局部候选最短距离）</td><td>输入：同一个节点v的所有候选新距离<br>聚合：保留v的最小距离（全局最短）<br>输出：<code>v\t全局最短距离</code></td></tr><tr><td>终止</td><td>当某轮Reduce输出的距离表无更新（收敛），停止迭代</td><td>-</td></tr></tbody></table><h4 id="pagerank-网页权重排名" tabindex="-1"><a class="header-anchor" href="#pagerank-网页权重排名"><span>PageRank（网页权重排名）</span></a></h4><h5 id="经典思路-核心-2" tabindex="-1"><a class="header-anchor" href="#经典思路-核心-2"><span>经典思路（核心）</span></a></h5><p>衡量网页重要性：一个网页的权重 = 所有指向它的网页的权重 / 指向网页的出度之和，加上阻尼系数（避免死链）。<br> 并行化核心：把网页链接关系分片，多节点同时计算局部网页的权重贡献，再汇总全局权重。</p><h5 id="map-reduce分工-2" tabindex="-1"><a class="header-anchor" href="#map-reduce分工-2"><span>Map/Reduce分工</span></a></h5><table><thead><tr><th>阶段</th><th>Map函数做什么</th><th>Reduce函数做什么</th></tr></thead><tbody><tr><td>初始化</td><td>读取网页链接数据（格式：<code>网页A\t[网页B, 网页C]</code>），给每个网页初始化权重（如所有网页权重=1/N，N是总网页数）<br>输出：<code>网页ID\t(权重, 出链列表)</code></td><td>无（第一轮初始化权重）</td></tr><tr><td>迭代计算</td><td>输入：上一轮Reduce输出的「网页-权重+出链」<br>对网页A（权重R，出链数k），给每个出链网页B分配权重：<code>R/k</code><br>输出：<br>- <code>网页B\t分配的权重</code>（贡献值）<br>- <code>网页A\t出链列表</code>（保留链接关系，供下一轮用）</td><td>输入：<br>1. 同一个网页的所有贡献值<br>2. 网页的出链列表<br>聚合计算：<br>新权重 = 阻尼系数*总贡献值 + (1-阻尼系数)/N<br>输出：<code>网页ID\t(新权重, 出链列表)</code></td></tr><tr><td>终止</td><td>当某轮权重变化率&lt;阈值（收敛），停止迭代</td><td>-</td></tr></tbody></table><h4 id="k-means聚类-你的代码核心" tabindex="-1"><a class="header-anchor" href="#k-means聚类-你的代码核心"><span>K-Means聚类（你的代码核心）</span></a></h4><h5 id="经典思路-核心-3" tabindex="-1"><a class="header-anchor" href="#经典思路-核心-3"><span>经典思路（核心）</span></a></h5><p>K-Means原本是单机算法：随机选k个聚类中心 → 所有样本分配到最近的中心 → 重新计算每个类的中心 → 循环直到中心不变。<br> 并行化核心：把样本分片，多节点同时分配样本到中心，再汇总所有样本重新计算全局中心。</p><h5 id="map-reduce分工-3" tabindex="-1"><a class="header-anchor" href="#map-reduce分工-3"><span>Map/Reduce分工</span></a></h5><table><thead><tr><th>阶段</th><th>Map函数做什么</th><th>Reduce函数做什么</th></tr></thead><tbody><tr><td>初始化</td><td>读取样本数据，加载初始聚类中心（存储于HDFS上的文件）<br>此阶段不涉及Map/Reduce计算，仅将聚类中心文件分发到集群</td><td>-</td></tr><tr><td>迭代计算（Map）</td><td>输入：样本数据 + 聚类中心<br>对每个样本，计算到k个中心的距离，分配到最近的中心<br>输出：<code>中心ID\t(样本特征, 1)</code>（1是样本计数）</td><td>输入：同一个中心ID的所有样本<br>聚合计算：<br>1. 汇总该类所有样本的特征之和<br>2. 统计该类样本总数<br>3. 计算新中心 = 特征之和 / 样本总数<br>输出：<code>中心ID\t新中心坐标</code></td></tr><tr><td>收敛判断</td><td>对比本轮新中心和上一轮旧中心的距离（Norm值），若&lt;阈值则停止</td><td>-</td></tr></tbody></table><h3 id="补充说明" tabindex="-1"><a class="header-anchor" href="#补充说明"><span>补充说明</span></a></h3><p>在经典的MapReduce（如Hadoop）框架中，除了Mapper和Reducer，还有几个关键的“er”组件，它们共同协作完成分布式计算任务。下面是常见的几个：</p><table><thead><tr><th>组件</th><th>作用</th><th>出现阶段</th></tr></thead><tbody><tr><td><strong>Combiner</strong></td><td>本地聚合器，在Map端先对输出做一次合并（类似小型的Reduce），减少网络传输的数据量。</td><td>Map阶段之后，Shuffle之前</td></tr><tr><td><strong>Partitioner</strong></td><td>决定Map输出的每个键值对应该被发送到哪个Reducer（通过计算键的哈希值等）。</td><td>Map输出写入环形缓冲区时</td></tr><tr><td><strong>Shuffler</strong></td><td>不是独立组件，而是指Map输出传输到Reducer的过程，包括排序、合并、复制等。</td><td>Map和Reduce之间的数据传输阶段</td></tr><tr><td><strong>RecordReader</strong></td><td>将输入分片解析成键值对（如文本文件的一行作为一个值，偏移量作为键）。</td><td>Map任务读取输入数据时</td></tr><tr><td><strong>RecordWriter</strong></td><td>将Reduce输出的键值对写入最终文件（如文本文件、SequenceFile等）。</td><td>Reduce任务输出结果时</td></tr></tbody></table></div><!----><!----><!----></div><footer class="vp-page-meta"><!----><div class="vp-meta-item git-info"><div class="update-time"><span class="vp-meta-label">最近更新: </span><time class="vp-meta-info" datetime="2026-02-26T10:30:12.000Z" data-allow-mismatch>2026/2/26 10:30</time></div><div class="contributors"><span class="vp-meta-label">贡献者: </span><!--[--><!--[--><span class="vp-meta-info" title="email: yusihong073@gmail.com">shyu216</span><!--]--><!--]--></div></div></footer><nav class="vp-page-nav"><!----><a class="route-link auto-link next" href="/knownoevil/study/bscs/22T1/ESTR2106.html" aria-label="ESTR2106"><div class="hint">下一页<span class="arrow end"></span></div><div class="link">ESTR2106<i class="vp-icon fas fa-book-open" sizing="height"></i></div></a></nav><!----><!----><!--]--></main><!--]--><footer class="vp-footer-wrapper" vp-footer><div class="vp-footer">A place to jot down the picked up.</div><div class="vp-copyright">Copyright © 2026 Dale </div></footer></div><!--]--><!--]--><!--[--><!----><!----><!--[--><!--]--><!--]--><!--]--></div>
    <script type="module" src="/knownoevil/assets/app-BJBWOcsO.js" defer></script>
  </body>
</html>
